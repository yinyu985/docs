import{_ as a,W as s,X as n,a0 as e}from"./framework-b4edc447.js";const p={},t=e(`<h1 id="备份并定时删除的脚本" tabindex="-1"><a class="header-anchor" href="#备份并定时删除的脚本" aria-hidden="true">#</a> 备份并定时删除的脚本</h1><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment">######################################################################################</span>
<span class="token comment">#!/bin/bash  </span>
<span class="token assign-left variable">date</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%Y%m%d%H<span class="token variable">)</span></span>  
<span class="token assign-left variable">backupdir</span><span class="token operator">=</span>/backup/mysql_backup
<span class="token function">mkdir</span> <span class="token parameter variable">-p</span> <span class="token variable">$backupdir</span>
mysqldump <span class="token parameter variable">-u</span> root <span class="token parameter variable">-h</span> <span class="token number">10.23</span>.140.174  <span class="token parameter variable">-pXxxxxxxxxxx</span> <span class="token parameter variable">--databases</span> grafana <span class="token operator">&gt;</span>/backup/mysql_backup/mysql_174_grafana_<span class="token variable">$date</span>.sql  
<span class="token function">find</span> <span class="token variable">\${backupdir}</span> <span class="token parameter variable">-mtime</span> +30 <span class="token parameter variable">-name</span> <span class="token string">&#39;*.sql&#39;</span> <span class="token parameter variable">-exec</span> <span class="token function">rm</span> <span class="token parameter variable">-rf</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token punctuation">\\</span><span class="token punctuation">;</span>   <span class="token comment">##清除30天前的备份</span>
<span class="token comment">######################################################################################</span>

<span class="token comment">#!/bin/bash</span>
<span class="token comment">#为 prometheus,alertmanager,nginx的配置文件做备份</span>
filelist<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">&#39;/home/alertmanager-0.24.0.linux-amd64/alertmanager.yml&#39;</span>
filelist<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">&#39;/home/prometheus-2.31.1.linux-amd64/prometheus.yml&#39;</span>
filelist<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">&#39;/home/prometheus-2.31.1.linux-amd64/rules/&#39;</span>
filelist<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">&#39;/home/prometheus-2.31.1.linux-amd64/BeiJing/&#39;</span>
filelist<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">&#39;/home/prometheus-2.31.1.linux-amd64/ShangHai/&#39;</span>
filelist<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">&#39;/home/prometheus-2.31.1.linux-amd64/WuHan/&#39;</span>
filelist<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">&#39;/home/prometheus-2.31.1.linux-amd64/Azure/&#39;</span>
filelist<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">&#39;/home/nginx/conf/conf.d/&#39;</span>


<span class="token assign-left variable">time</span><span class="token operator">=</span><span class="token variable"><span class="token variable">\`</span><span class="token function">date</span> +%m%d%H%M<span class="token variable">\`</span></span>
<span class="token assign-left variable">backupdir</span><span class="token operator">=</span><span class="token string">&quot;/backup/<span class="token variable">\${time}</span>&quot;</span>
<span class="token function">mkdir</span> <span class="token parameter variable">-p</span> <span class="token variable">$backupdir</span>
<span class="token builtin class-name">echo</span> <span class="token variable">\${filelist<span class="token punctuation">[</span>*<span class="token punctuation">]</span>}</span>
<span class="token keyword">for</span> <span class="token for-or-select variable">i</span> <span class="token keyword">in</span> <span class="token variable">\${filelist<span class="token punctuation">[</span>*<span class="token punctuation">]</span>}</span>
<span class="token keyword">do</span>
  <span class="token function">cp</span> <span class="token parameter variable">-a</span> <span class="token variable">$i</span> <span class="token variable">\${backupdir}</span>/ <span class="token operator">&gt;</span>/dev/null <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token file-descriptor important">&amp;1</span>
<span class="token keyword">done</span>
<span class="token function">find</span> <span class="token builtin class-name">.</span> <span class="token parameter variable">-type</span> d <span class="token parameter variable">-mtime</span> +20  <span class="token parameter variable">-exec</span>  <span class="token function">rm</span> <span class="token parameter variable">-rf</span>  <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token punctuation">\\</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,2),l=[t];function i(o,c){return s(),n("div",null,l)}const u=a(p,[["render",i],["__file","备份并定时删除的脚本.html.vue"]]);export{u as default};
