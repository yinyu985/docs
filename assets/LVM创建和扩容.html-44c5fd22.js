import{_ as n,W as s,X as a,a0 as e}from"./framework-b4edc447.js";const i={},d=e(`<h1 id="lvm创建和扩容" tabindex="-1"><a class="header-anchor" href="#lvm创建和扩容" aria-hidden="true">#</a> LVM创建和扩容</h1><h2 id="创建一个lvm" tabindex="-1"><a class="header-anchor" href="#创建一个lvm" aria-hidden="true">#</a> 创建一个LVM</h2><p>LVM是 Logical Volume Manager（逻辑卷管理器）的简写，它是Linux环境下对磁盘分区进行管理的一种机制。LVM将一个或多个磁盘分区（PV）虚拟为一个卷组（VG），相当于一个大的硬盘，我们可以在上面划分一些逻辑卷（LV）。当卷组的空间不够使用时，可以将新的磁盘分区加入进来。我们还可以从卷组剩余空间上划分一些空间给空间不够用的逻辑卷使用。</p><figure><img src="https://s2.loli.net/2022/08/20/HIeMkpU5TbfzmtN.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>将硬盘或者硬盘分组，创建为物理卷（PV）&gt;&gt;&gt;将PV进入到卷组（VG）&gt;&gt;&gt;将卷组分成逻辑卷（LV）</p><p>首先确定系统中是否安装了lvm工具：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">rpm</span> –qa <span class="token operator">|</span> <span class="token function">grep</span> lvm
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>如果命令结果输出rpm版本，那么说明系统已经安装了LVM管理工具；如果命令没有输出则说明没有安装LVM管理工具，则需要从网络下载或者从光盘装LVM rpm工具包。</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>yum <span class="token function">install</span> <span class="token parameter variable">-y</span> lvm2
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="查看硬盘" tabindex="-1"><a class="header-anchor" href="#查看硬盘" aria-hidden="true">#</a> 查看硬盘</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>lsblk #也可以通过fdisk -l 查看硬盘
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://s2.loli.net/2022/08/20/nJB3aSkOzVWN4YA.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="对硬盘进行分区" tabindex="-1"><a class="header-anchor" href="#对硬盘进行分区" aria-hidden="true">#</a> 对硬盘进行分区</h2><p>fdisk 里面的具体操作，可输入 m 进行帮助。最常用的是 n（新建）d（删除）p（打印）q（退出）t（修改系统标识符）w（写入并退出）</p><blockquote><p>也可以不分区，我这里就没有分区，分区的意义在于，不把鸡蛋放在同一个篮子里，格式化时不用全部格式化，可以保留部分文件。</p></blockquote><p>改变系统标识符：</p><p>输入 t 改变分区1的属性</p><p>输入 L 查看有个属性对应的命令</p><p>输入 8e 改变分区1为 Linux LVM格式</p><p>输入 p 打印分区情况查看是否是 Linux LVM 格式</p><blockquote><p>没有修改分区的属性，添加到lvm里面也没有出问题，不知为何，可能pvcreate时已经完成了相应操作</p></blockquote><h2 id="创建物理卷" tabindex="-1"><a class="header-anchor" href="#创建物理卷" aria-hidden="true">#</a> 创建物理卷</h2><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>pvcreate /dev/vdb /dev/vdc /dev/vdd /dev/vde /dev/vdf
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://s2.loli.net/2022/08/20/tk4m9aEjLn5zV7d.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="创建卷组" tabindex="-1"><a class="header-anchor" href="#创建卷组" aria-hidden="true">#</a> 创建卷组</h2><p>创建一个卷组把刚才创建的物理卷加入到卷组</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>vgcreate lvm_01 /dev/vdb /dev/vdc /dev/vdd /dev/vde /dev/vdf
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://s2.loli.net/2022/08/20/H2q9A4n1CNlwdQs.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="创建逻辑卷" tabindex="-1"><a class="header-anchor" href="#创建逻辑卷" aria-hidden="true">#</a> 创建逻辑卷</h2><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>lvcreate <span class="token parameter variable">-L</span> 150g <span class="token parameter variable">-n</span> lv01 lvm_01
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>用lvm_01这个卷组创建一个逻辑卷名叫 lv01，-L用于指定逻辑卷的大小，支持单位M,G,T</p><figure><img src="https://s2.loli.net/2022/08/20/qNjA9c1EsZkbyRL.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>使用以下命令查看逻辑卷详细信息。</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>lvdisplay
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="给现有的lvm扩容" tabindex="-1"><a class="header-anchor" href="#给现有的lvm扩容" aria-hidden="true">#</a> 给现有的LVM扩容</h2><figure><img src="https://s2.loli.net/2022/08/20/nm8iRBaYfkT3jlZ.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>此时，LVM已经创建完成，需要创建文件系统后挂载</p><h2 id="创建文件系统并挂载" tabindex="-1"><a class="header-anchor" href="#创建文件系统并挂载" aria-hidden="true">#</a> 创建文件系统并挂载</h2><p>创建一个ext4文件系统</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>mkfs.ext4 /dev/lvm_01/lv01
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>创建一个xfs文件系统</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>mkfs.xfs /dev/lvm_01/lv01
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>创建挂载点，例如/media/lv01。</p><p>如果已有的挂载点，可以跳过此步骤。</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">mkdir</span> /media/lv01
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>将创建的文件系统挂载到挂载点</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">mount</span> /dev/lvm_01/lv01 /media/lv01
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h1 id="给现有逻辑卷扩容" tabindex="-1"><a class="header-anchor" href="#给现有逻辑卷扩容" aria-hidden="true">#</a> 给现有逻辑卷扩容</h1><p>fdisk -l 查看有一块新加的硬盘<code>/dev/sdd</code></p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">fdisk</span> <span class="token parameter variable">-l</span>
磁盘 /dev/sda：32.2 GB, <span class="token number">32212254720</span> 字节，62914560 个扇区
Units <span class="token operator">=</span> 扇区 of <span class="token number">1</span> * <span class="token number">512</span> <span class="token operator">=</span> <span class="token number">512</span> bytes
扇区大小<span class="token punctuation">(</span>逻辑/物理<span class="token punctuation">)</span>：512 字节 / <span class="token number">4096</span> 字节
I/O 大小<span class="token punctuation">(</span>最小/最佳<span class="token punctuation">)</span>：4096 字节 / <span class="token number">4096</span> 字节
磁盘标签类型：dos
磁盘标识符：0x000ecbd2
   设备 Boot      Start         End      Blocks   Id  System
/dev/sda1   *        <span class="token number">2048</span>     <span class="token number">1026047</span>      <span class="token number">512000</span>   <span class="token number">83</span>  Linux
/dev/sda2         <span class="token number">1026048</span>    <span class="token number">62914559</span>    <span class="token number">30944256</span>   <span class="token number">83</span>  Linux
磁盘 /dev/sdb：1099.5 GB, <span class="token number">1099511627776</span> 字节，2147483648 个扇区
Units <span class="token operator">=</span> 扇区 of <span class="token number">1</span> * <span class="token number">512</span> <span class="token operator">=</span> <span class="token number">512</span> bytes
扇区大小<span class="token punctuation">(</span>逻辑/物理<span class="token punctuation">)</span>：512 字节 / <span class="token number">4096</span> 字节
I/O 大小<span class="token punctuation">(</span>最小/最佳<span class="token punctuation">)</span>：4096 字节 / <span class="token number">4096</span> 字节
磁盘标签类型：dos
磁盘标识符：0x05008ad2
   设备 Boot      Start         End      Blocks   Id  System
/dev/sdb1            <span class="token number">2048</span>  <span class="token number">2147483647</span>  <span class="token number">1073740800</span>   <span class="token number">83</span>  Linux
磁盘 /dev/mapper/centos-data：2194.7 GB, <span class="token number">2194724093952</span> 字节，4286570496 个扇区
Units <span class="token operator">=</span> 扇区 of <span class="token number">1</span> * <span class="token number">512</span> <span class="token operator">=</span> <span class="token number">512</span> bytes
扇区大小<span class="token punctuation">(</span>逻辑/物理<span class="token punctuation">)</span>：512 字节 / <span class="token number">4096</span> 字节
I/O 大小<span class="token punctuation">(</span>最小/最佳<span class="token punctuation">)</span>：4096 字节 / <span class="token number">4096</span> 字节
磁盘 /dev/sdc：1099.5 GB, <span class="token number">1099511627776</span> 字节，2147483648 个扇区
Units <span class="token operator">=</span> 扇区 of <span class="token number">1</span> * <span class="token number">512</span> <span class="token operator">=</span> <span class="token number">512</span> bytes
扇区大小<span class="token punctuation">(</span>逻辑/物理<span class="token punctuation">)</span>：512 字节 / <span class="token number">4096</span> 字节
I/O 大小<span class="token punctuation">(</span>最小/最佳<span class="token punctuation">)</span>：4096 字节 / <span class="token number">4096</span> 字节
磁盘标签类型：dos
磁盘标识符：0x10a5ae44
   设备 Boot      Start         End      Blocks   Id  System
/dev/sdc1            <span class="token number">2048</span>  <span class="token number">2147483647</span>  <span class="token number">1073740800</span>   <span class="token number">83</span>  Linux
磁盘 /dev/sdd：1099.5 GB, <span class="token number">1099511627776</span> 字节，2147483648 个扇区
Units <span class="token operator">=</span> 扇区 of <span class="token number">1</span> * <span class="token number">512</span> <span class="token operator">=</span> <span class="token number">512</span> bytes
扇区大小<span class="token punctuation">(</span>逻辑/物理<span class="token punctuation">)</span>：512 字节 / <span class="token number">4096</span> 字节
I/O 大小<span class="token punctuation">(</span>最小/最佳<span class="token punctuation">)</span>：4096 字节 / <span class="token number">4096</span> 字节
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="对磁盘进行分区" tabindex="-1"><a class="header-anchor" href="#对磁盘进行分区" aria-hidden="true">#</a> 对磁盘进行分区</h2><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">fdisk</span> /dev/sdd
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="使内核重新读取分区表" tabindex="-1"><a class="header-anchor" href="#使内核重新读取分区表" aria-hidden="true">#</a> 使内核重新读取分区表</h2><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>partprobe
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="创建物理卷-1" tabindex="-1"><a class="header-anchor" href="#创建物理卷-1" aria-hidden="true">#</a> 创建物理卷</h2><p>扫描系统PV：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>pvscan
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>创建PV：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>pvcreate /dev/sdd1
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>查看PV：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>pvdisplay
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="查看现有的卷组" tabindex="-1"><a class="header-anchor" href="#查看现有的卷组" aria-hidden="true">#</a> 查看现有的卷组</h2><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>lvdisplay
  --- Logical volume ---
  LV Path                /dev/centos/data
  LV Name                data
  VG Name                centos
  LV UUID                1annzJ-OeMD-GGAi-Ej1N-mkSV-jnNB-4IFj0d
  LV Write Access        read/write
  LV Creation host, <span class="token function">time</span> ElasticSearch-node3, <span class="token number">2022</span>-03-03 <span class="token number">16</span>:07:24 +0800
  LV Status              available
  <span class="token comment"># open                 1</span>
  LV Size                <span class="token operator">&lt;</span><span class="token number">3.00</span> TiB
  Current LE             <span class="token number">786429</span>
  Segments               <span class="token number">4</span>
  Allocation             inherit
  Read ahead sectors     auto
  - currently <span class="token builtin class-name">set</span> to     <span class="token number">8192</span>
  Block device           <span class="token number">253</span>:0
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="将新建的物理卷加到卷组" tabindex="-1"><a class="header-anchor" href="#将新建的物理卷加到卷组" aria-hidden="true">#</a> 将新建的物理卷加到卷组</h2><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>vgextend centos /dev/sdd1
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="将卷组里空余加到逻辑卷" tabindex="-1"><a class="header-anchor" href="#将卷组里空余加到逻辑卷" aria-hidden="true">#</a> 将卷组里空余加到逻辑卷</h2><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>lvextend <span class="token parameter variable">-l</span> +100%FREE /dev/centos/data
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>加完了并没有万事大吉</p><p>查看文件系统的类型</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>df -T
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>文件系统                类型        1K-块    已用     可用 已用% 挂载点
/dev/mapper/centos-root xfs      <span class="token number">52403200</span> <span class="token number">1913936</span> <span class="token number">50489264</span>    <span class="token number">4</span>% /
devtmpfs                devtmpfs  <span class="token number">1964224</span>       <span class="token number">0</span>  <span class="token number">1964224</span>    <span class="token number">0</span>% /dev
tmpfs                   tmpfs     <span class="token number">1976320</span>       <span class="token number">0</span>  <span class="token number">1976320</span>    <span class="token number">0</span>% /dev/shm
tmpfs                   tmpfs     <span class="token number">1976320</span>   <span class="token number">11908</span>  <span class="token number">1964412</span>    <span class="token number">1</span>% /run
tmpfs                   tmpfs     <span class="token number">1976320</span>       <span class="token number">0</span>  <span class="token number">1976320</span>    <span class="token number">0</span>% /sys/fs/cgroup
/dev/sda1               xfs       <span class="token number">1038336</span>  <span class="token number">135236</span>   <span class="token number">903100</span>   <span class="token number">14</span>% /boot
/dev/mapper/centos-home xfs      <span class="token number">26324420</span>   <span class="token number">32992</span> <span class="token number">26291428</span>    <span class="token number">1</span>% /home
tmpfs                   tmpfs      <span class="token number">395268</span>       <span class="token number">0</span>   <span class="token number">395268</span>    <span class="token number">0</span>% /run/user/0


xfs_growfs /dev/centos/data      <span class="token comment">##当逻辑卷文件系统为xfs使用</span>
resize2fs /dev/centos/data       <span class="token comment">##当逻辑卷文件系统为ext4使用</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,71),l=[d];function r(t,c){return s(),a("div",null,l)}const u=n(i,[["render",r],["__file","LVM创建和扩容.html.vue"]]);export{u as default};
