import{_ as i,W as r,X as p,Y as s,Z as a,$ as t,a0 as n,D as o}from"./framework-b4edc447.js";const l={},c=n(`<h1 id="å¤„ç†kafkaæ•…éšœå…¨æµç¨‹" tabindex="-1"><a class="header-anchor" href="#å¤„ç†kafkaæ•…éšœå…¨æµç¨‹" aria-hidden="true">#</a> å¤„ç†kafkaæ•…éšœå…¨æµç¨‹</h1><p>ä»Šå¤©ä¸­åˆæ•£æ­¥å›æ¥ï¼Œç¾å¥³åŒäº‹è·Ÿæˆ‘è¯´ï¼Œæœ€è¿‘çš„æ—¥å¿—æ²¡æœ‰è¿›æ¥ï¼Œæˆ‘ç™»ä¸Škibanaä¸€çœ‹ï¼Œæˆ‘é ï¼Œè¿‘ä¸¤å¤©çš„æ—¥å¿—å…¨æ²¡æœ‰ï¼ˆéƒ¨åˆ†ç´¢å¼•æœ‰ï¼Œéƒ¨åˆ†ç´¢å¼•é‡å˜å°‘äº†ï¼Œéƒ¨åˆ†ç´¢å¼•å®Œå…¨æ²¡æœ‰æ–°æ—¥å¿—è¿›æ¥ï¼‰ã€‚æ€ä¹ˆåŠï¼Œçœ‹æ—¥å¿—å‘—ï¼Œæ¯•ç«Ÿå’±ä¸èƒ½åƒç¾å¥³åŒäº‹ä¸€æ ·æŠŠè¿™ä¸ªæƒ…å†µå‘Šè¯‰åˆ«äººç„¶åæ‘†çƒ‚å§ï¼Œæœ¬æ–‡è®°å½•å¤„ç†çš„å…¨æµç¨‹ã€‚<!--more--></p><p>kibanaçœ‹ä¸åˆ°æ—¥å¿—ï¼Œè¯´æ˜æ²¡è¿›esï¼Œç™»å½•logstashæŸ¥çœ‹logstashæ—¥å¿—æ˜¾ç¤ºå¦‚ä¸‹</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token number">12</span> partitions have leader brokers without a matching listener, including <span class="token punctuation">[</span>koala-0, SDP_system-0, prometheus-0, network_23_clearpass-0, network_35_Aruba-system-0, aduser_change-0, nuc-0, nginx_test-0, Network_23_RS_Device-0, network_35_zdns-0<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>ä¸å¾—ä¸è¯´Javaç¨‹åºçš„æ—¥å¿—å°±æ˜¯è€å¤ªå¤ªçš„è£¹è„šå¸ƒåˆè‡­åˆé•¿ï¼Œä¸Šé¢åªè´´äº†å…³é”®éƒ¨åˆ†ã€‚</p><p>ä¸‹é¢ä»‹ç»ä¸€ä¸‹æˆ‘çš„æ–°åŒäº‹---chatGPTï¼Œä¸å¾—ä¸è¯´ä¸€ä¸ªæ‹¥æœ‰å…¨äººç±»çŸ¥è¯†ç»“æ™¶å¹¶ä¸”èƒ½å¤Ÿç†è§£åˆ†æçš„äººå·¥æ™ºèƒ½å¾ˆç‰›é€¼ã€‚è‡³äºä»€ä¹ˆå¤±ä¸šï¼Œä¸åœ¨æœ¬æ–‡çš„è®¨è®ºèŒƒå›´å†…ï¼Œæ¯•ç«ŸAIåªèƒ½æä¾›æ€è·¯ï¼Œæš‚æ—¶æˆ‘è¿˜ä¸èƒ½å¤±ä¸šã€‚</p><figure><img src="https://s2.loli.net/2023/02/27/qGRxI4yaOKpY6NF.png" alt="image-20230227215925115" tabindex="0" loading="lazy"><figcaption>image-20230227215925115</figcaption></figure><p>ç°åœ¨æ¥åˆ†æåˆ†ææˆ‘è¿™ä½åŒäº‹çš„åˆ†æ</p><ul><li>ç¡®å®æ˜¯éƒ¨åˆ†åˆ†åŒºæœ‰leader brokerï¼Œä½†æ˜¯æ²¡æœ‰listenerï¼ˆå¹¶ä¸”åé¢åˆ—å‡ºæ¥äº†è¯¦ç»†çš„12ä¸ªåˆ†åŒºï¼‰</li><li>æ£€æŸ¥brokeré…ç½®ï¼Œè¿™ä¸ªä¸œè¥¿æ­£å¸¸è¿è¡Œï¼Œæ ¹æœ¬æ²¡äººä¼šåŠ¨ã€‚</li><li>æ£€æŸ¥ç½‘ç»œè¿æ¥ï¼Œè¿™ä¸‰å°kafkaç»„æˆçš„é›†ç¾¤æ˜¯åœ¨Azureä¸Šçš„ï¼Œå‡ºç°ç½‘ç»œé—®é¢˜çš„å¯èƒ½æ€§ä¸å¤§å§ï¼Œå°†ä¿¡å°†ç–‘pingäº†ä¸€ä¸‹ï¼Œæ²¡å•¥é—®é¢˜ã€‚</li><li>æ£€æŸ¥åˆ†åŒºé…ç½®ï¼ŒåŒä¸Šï¼Œæ²¡äººåŠ¨çš„ã€‚</li></ul>`,9),k={href:"https://github.com/provectus/kafka-ui",target:"_blank",rel:"noopener noreferrer"},d=n('<p>é€šè¿‡æŸ¥çœ‹kafka-uiå‘ç°é›†ç¾¤ä¸­ç¡®å®æœ‰å¼‚æ ·</p><figure><img src="https://s2.loli.net/2023/02/27/ozhYHmwel3v2ZyO.png" alt="image-20230227221802513" tabindex="0" loading="lazy"><figcaption>image-20230227221802513</figcaption></figure><p>ä¸Šå›¾åœˆå‡ºæ¥çš„å°±æ˜¯ç”Ÿäº§é›†ç¾¤çš„Partitionså¼‚å¸¸ï¼Œæ˜¾ç¤ºæœ‰68ä¸ªOnline,å°è„‘ç“œä¸€è½¬ï¼Œé‚£ä¸å°±æ˜¯æœ‰12ä¸ªofflineå—ï¼Ÿ12ä¸å°±æ˜¯åˆšæ‰logstashæ—¥å¿—é‡Œé¢æŠ¥é”™æœ‰12ä¸ªåˆ†åŒºå¼‚å¸¸å—ï¼Ÿè‡³äºæ—è¾¹çš„URPåˆšå¥½ä¹Ÿæ˜¯12ï¼Œé—®é—®æˆ‘åŒäº‹è¿™å•¥æ„æ€ï¼Ÿ</p><figure><img src="https://s2.loli.net/2023/02/27/2jvOLwIe7cUWYQt.png" alt="image-20230227222124718" tabindex="0" loading="lazy"><figcaption>image-20230227222124718</figcaption></figure><p>çœ‹åˆ°æ²¡ï¼Œæˆ‘åŒäº‹çœŸç‰›é€¼ï¼Œæ²¡ä¸‰åå¹´è¿ç»´ç»éªŒèƒ½åšåˆ°è¿™èˆ¬å¯¹ç­”å¦‚æµï¼Ÿè¯•é—®å„ä½çœ‹å®˜ä½ ä»¬å¯ä»¥å—ï¼Ÿ</p><p>çœ‹æˆ‘ç”»çš„çº¢åœˆï¼Œæ ¹æ®logstashæ—¥å¿—å’Œkafka-uiï¼Œå¾—å‡ºå¤§æ¦‚ç»“è®ºï¼Œå› ä¸ºbrokerå‘ç”Ÿæ•…éšœå¯¼è‡´åŒæ­¥å¤±è´¥ï¼Œè¿›å…¥URPçŠ¶æ€ï¼Œäº§ç”Ÿoffline Partition</p><p>é‚£ä¹ˆé—®é¢˜æ¥äº†æ€ä¹ˆè§£å†³å‘¢ï¼Ÿ</p><figure><img src="https://s2.loli.net/2023/02/27/o7NAkqiQGcVYt5s.png" alt="image-20230227222925670" tabindex="0" loading="lazy"><figcaption>image-20230227222925670</figcaption></figure><p>ä»–å¥½åƒä»€ä¹ˆéƒ½è¯´äº†åˆå¥½åƒä»€ä¹ˆéƒ½æ²¡è¯´ï¼Œ</p><ol><li>æ£€æŸ¥çŠ¶æ€ï¼Œæ²¡å‘ç°é—®é¢˜ï¼Œkafkaæœºå™¨ç¨³å®šè¿è¡Œï¼Œè´Ÿè½½æ­£å¸¸ï¼Œç½‘ç»œç•…é€šã€‚</li><li>å¾—ç›ŠäºJavaæ—¥å¿—æ–‡ä»¶åˆè‡­åˆé•¿ï¼Œæ²¡çœ‹åˆ°ä»€ä¹ˆæ•…éšœåŸå› ã€‚</li><li>ä¿®å¤ï¼Œä¸ç”¨ä¿®å¤äº†ï¼Œkafkaå’Œzookeeperè¿›ç¨‹éƒ½åœ¨ï¼Œéƒ¨åˆ†ç´¢å¼•ä¹Ÿåœ¨â€œæ­£å¸¸â€è¿›å…¥esï¼Œåªæ˜¯é‡å°‘äº†ç‚¹ã€‚</li><li>å‰¯æœ¬ï¼Œæˆ‘ä»¬kafkaé›†ç¾¤ä»å¼€å§‹è¿è¡Œç§‰æ‰¿ç€èƒ½è·‘å°±è¡Œçš„åŸåˆ™ï¼Œè®¾ç½®çš„å‰¯æœ¬æ•°å°±æ˜¯1ï¼ŒğŸ¤¦ğŸ»â€â™‚ï¸.jpgï¼Œç°åœ¨è´¸ç„¶å¢å‡ä¸æ˜¾ç¤ºï¼Œä¸‡ä¸€å¯¹ç›®å‰æ­£å¸¸å¤„ç†çš„ç´¢å¼•æ¥ä¸ªæ´—ç‰Œå²‚ä¸GGï¼Ÿ</li><li>åˆ†åŒºé‡æ–°åˆ†é…ï¼Œæˆ‘ä»¬æœ€ç»ˆè§£å†³é—®é¢˜çš„æœ€ç»ˆæˆåŠŸçš„åŸå› åº”è¯¥å°±æ˜¯è¿™ä¸ª</li><li>ç›‘æ§brokerï¼Œç¡®å®ï¼Œç»è¿‡è¿™æ¬¡æ•™è®­ï¼Œåé¢Partitionå’Œbreokerçš„å‘Šè­¦è§„åˆ™ä¹Ÿè¦ä¹Ÿå†™èµ·æ¥äº†ï¼Œè£…äº†kafka_exporteråªä¸ºåšçœ‹æ¿ç»™é¢†å¯¼è£…é€¼ï¼Œå®é™…å¹¶æ²¡æœ‰ä»»ä½•å‘Šè­¦ç­–ç•¥ï¼ŒğŸ¤¦ğŸ»â€â™‚ï¸.jpgã€‚</li></ol>',10),m={href:"https://zhuanlan.zhihu.com/p/590443597",target:"_blank",rel:"noopener noreferrer"},u=n(`<div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token builtin class-name">cd</span> /data/kafka_2.11-2.2.1/bin <span class="token operator">&amp;&amp;</span> ./kafka-topics.sh <span class="token parameter variable">--describe</span> <span class="token parameter variable">--zookeeper</span> localhost:2181  <span class="token operator">|</span><span class="token function">grep</span> Leader
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>é€šè¿‡ä¸Šè¿°å‘½ä»¤æŸ¥çœ‹å„ä¸ªtopicçš„çŠ¶æ€ï¼Œå‘ç°æœ‰12çš„topicçš„Leaderæ˜¯-1ï¼Œåˆšå¥½å°±æ˜¯ä¸€å¼€å§‹å‡ºç°é—®é¢˜çš„é‚£å‡ ä¸ªï¼Œè¿™æ˜¯ä¸æ­£å¸¸çš„ã€‚</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>	Topic: Network_23_RS_Device	Partition: <span class="token number">0</span>	Leader: <span class="token parameter variable">-1</span>	Replicas: <span class="token number">1</span>	Isr: <span class="token number">1</span>
	Topic: SDP_system	Partition: <span class="token number">0</span>	Leader: <span class="token parameter variable">-1</span>	Replicas: <span class="token number">1</span>	Isr: <span class="token number">1</span>
	Topic: aduser_change	Partition: <span class="token number">0</span>	Leader: <span class="token parameter variable">-1</span>	Replicas: <span class="token number">1</span>	Isr: <span class="token number">1</span>
	Topic: aduser_change1	Partition: <span class="token number">0</span>	Leader: <span class="token parameter variable">-1</span>	Replicas: <span class="token number">1</span>	Isr: <span class="token number">1</span>
	Topic: koala	Partition: <span class="token number">0</span>	Leader: <span class="token parameter variable">-1</span>	Replicas: <span class="token number">1</span>	Isr: <span class="token number">1</span>
	Topic: ldap	Partition: <span class="token number">0</span>	Leader: <span class="token parameter variable">-1</span>	Replicas: <span class="token number">1</span>	Isr: <span class="token number">1</span>
	Topic: network_23_clearpass	Partition: <span class="token number">0</span>	Leader: <span class="token parameter variable">-1</span>	Replicas: <span class="token number">1</span>	Isr: <span class="token number">1</span>
	Topic: network_35_Aruba-system	Partition: <span class="token number">0</span>	Leader: <span class="token parameter variable">-1</span>	Replicas: <span class="token number">1</span>	Isr: <span class="token number">1</span>
	Topic: network_35_zdns	Partition: <span class="token number">0</span>	Leader: <span class="token parameter variable">-1</span>	Replicas: <span class="token number">1</span>	Isr: <span class="token number">1</span>
	Topic: nginx_test	Partition: <span class="token number">0</span>	Leader: <span class="token parameter variable">-1</span>	Replicas: <span class="token number">1</span>	Isr: <span class="token number">1</span>
	Topic: nuc	Partition: <span class="token number">0</span>	Leader: <span class="token parameter variable">-1</span>	Replicas: <span class="token number">1</span>	Isr: <span class="token number">1</span>
	Topic: prometheus	Partition: <span class="token number">0</span>	Leader: <span class="token parameter variable">-1</span>	Replicas: <span class="token number">1</span>	Isr: <span class="token number">1</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å…¶å®å¿™æ´»ä¸€å¤§ä¸‹åˆï¼Œæ™šä¸Šå¦ä¸€ä¸ªåŒäº‹ä¹Ÿè¿‡æ¥çœ‹æ€ä¹ˆè§£å†³ï¼Œä»–çš„çœ‹æ³•å°±æ˜¯é‡å¯å¤§æ³•ï¼Œæˆ‘çš„è§‚ç‚¹æ˜¯ï¼Œç°åœ¨å·²ç»å‡ºç°äº†æŠ¥é”™ï¼Œä¸è§£å†³è¿™äº›offlineçš„partition,ä¸‡ä¸€é‡å¯èµ·ä¸æ¥ä¸æ˜¯ç›´æ¥æ‡µé€¼ï¼Œåˆ°æ—¶å€™åªèƒ½ä¸ç®¡ä¸‰ä¸ƒäºŒåä¸€ï¼ŒæŠŠæ•´ä¸ªç›®å½•åˆ æ‰äº†ã€‚</p><p>äºæ˜¯æ¥ç€æŸ¥æ€æ ·å¤„ç†è¿™äº›offlineçš„partition</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token builtin class-name">cd</span> /data/kafka_2.11-2.2.1/bin
<span class="token comment">#è¿›å…¥åˆ°kafkaçš„å®‰è£…ç›®å½•</span>
./zookeeper-shell.sh localhost:2181
<span class="token comment">#ä½¿ç”¨è‡ªå¸¦çš„è„šæœ¬è¿æ¥åˆ°zookeeper</span>
rmr /brokers/topics/network_35_zdns/partitions/0
rmr /brokers/topics/Network_23_RS_Device/partitions/0
rmr /brokers/topics/SDP_system/partitions/0
rmr /brokers/topics/aduser_change/partitions/0
rmr /brokers/topics/aduser_change1/partitions/0
rmr /brokers/topics/koala/partitions/0
rmr /brokers/topics/ldap/partitions/0
rmr /brokers/topics/network_23_clearpass/partitions/0
rmr /brokers/topics/network_35_Aruba-system/partitions/0
rmr /brokers/topics/nginx_test/partitions/0
rmr /brokers/topics/nuc/partitions/0
rmr /brokers/topics/prometheus/partitions/0
<span class="token comment">#ä½¿ç”¨ä»¥ä¸Šå‘½ä»¤åˆ é™¤å¼‚å¸¸çš„topicçš„å¼‚å¸¸çš„partitionï¼Œæœ‰ä¸ªé—®é¢˜è¿™ä¸ªshellç§‰æ‰¿ç€linuxçš„è®¾è®¡ç†å¿µï¼Œæ²¡æœ‰æ¶ˆæ¯å°±æ˜¯å¥½æ¶ˆæ¯ã€‚</span>
<span class="token comment">#ä»¥è‡³äºæ‰§è¡Œåˆ é™¤å‘½ä»¤å¹¶æ²¡æœ‰ä»»ä½•è¿”å›ï¼Œäºæ˜¯æˆ‘é‡æ–°æ‰§è¡Œäº†ä¸€éï¼Œç„¶åå®ƒæŠ¥ï¼Œæ²¡æœ‰å•¥å•¥å•¥è¿™ä¸ªå•¥å•¥å•¥ï¼Œèˆ’é€‚ã€‚</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åˆ äº†ä¹‹åï¼Œäººå®¶é‡å¯äº†ï¼Œæˆ‘ä»¬ä¹Ÿå‡†å¤‡å‘½ä»¤é‡å¯äº†</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">ps</span> <span class="token parameter variable">-aux</span> <span class="token operator">|</span> <span class="token function">grep</span>   zooke <span class="token operator">|</span><span class="token function">grep</span> <span class="token parameter variable">-v</span> <span class="token function">grep</span> <span class="token operator">|</span><span class="token function">grep</span> <span class="token parameter variable">-v</span> exporter <span class="token operator">|</span><span class="token function">grep</span> <span class="token parameter variable">-v</span> dhcli <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">&#39;{print $2}&#39;</span><span class="token operator">|</span><span class="token function">xargs</span> <span class="token function">kill</span> <span class="token parameter variable">-9</span> 
<span class="token builtin class-name">cd</span> /data/kafka_2.11-2.2.1/bin <span class="token operator">&amp;&amp;</span> <span class="token function">nohup</span> ./zookeeper-server-start.sh <span class="token punctuation">..</span>/config/zookeeper.properties <span class="token operator">&amp;</span>
<span class="token builtin class-name">cd</span> /data/kafka_2.11-2.2.1/bin <span class="token operator">&amp;&amp;</span> <span class="token function">nohup</span> ./kafka-server-start.sh <span class="token punctuation">..</span>/config/server.properties <span class="token operator">&gt;</span> kafka.log <span class="token operator">&amp;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é‡å¯çœ‹æ—¥å¿—ï¼Œæ²¡æœ‰å‘ç°å¼‚å¸¸ï¼Œæ‰“å¼€kafka-uiçš„çœ‹æ¿ï¼Œofflineçš„æ•°é‡å…¨éƒ¨å›æ¥äº†ï¼ŒURPæ•°é‡ä¸º0ã€‚çš†å¤§æ¬¢å–œï¼Œå†å»kibanaçœ‹ï¼Œæ—¥å¿—å¼€å§‹è¿›æ¥äº†ã€‚</p>`,9);function b(v,g){const e=o("ExternalLinkIcon");return r(),p("div",null,[c,s("p",null,[a("ä¸‹é¢ä»‹ç»ä¸€ä¸ªkafkaçœ‹æ¿å·¥å…·ï¼Œ"),s("a",k,[a("kafka-ui"),t(e)]),a("æ”¯æŒå±•ç¤ºå¤šé›†ç¾¤ï¼Œæ”¯æŒå±•ç¤ºBrokersã€Topicsã€Consumersã€‚")]),d,s("p",null,[a("å½“ç„¶ä¹Ÿä¸èƒ½å…¨å¬æˆ‘åŒäº‹çš„ï¼Œåœ¨Googleä¸€ç•ªåæ‰¾åˆ°äº†ä¸€ç¯‡æ–‡ç« ï¼Œæœ‰éƒ¨åˆ†å‚è€ƒä»·å€¼ï¼Œ ç›´æ¥çœ‹ç¬¬ä¸‰ç‚¹---"),s("a",m,[a("offline partitionå¼‚å¸¸å¤„ç†"),t(e)])]),u])}const _=i(l,[["render",b],["__file","å¤„ç†kafkaæ•…éšœå…¨æµç¨‹.html.vue"]]);export{_ as default};
